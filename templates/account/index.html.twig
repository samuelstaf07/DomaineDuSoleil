{% extends 'base.html.twig' %}

{% block title %}Votre compte{% endblock %}

{% block body %}
    <div class="contentMargin d-flex flex-column align-items-center justify-content-center gap-4">
        <div class="d-flex gap-2 mb-4">
            <a href="{{ path('app_account_section', {section: 'bills'}) }}" data-turbo-frame="account-section" class="btn-black">Factures</a>
            <a href="{{ path('app_account_section', {section: 'rentals'}) }}" data-turbo-frame="account-section" class="btn-lightGreen">Réservations Logement</a>
            <a href="{{ path('app_account_section', {section: 'events'}) }}" data-turbo-frame="account-section" class="btn-yellow">Réservations Événement</a>
            <a href="{{ path('app_account_section', {section: 'settings'}) }}" data-turbo-frame="account-section" class="btn-lightGreen2">Votre compte</a>
        </div>

        <turbo-frame id="account-section" class="w-75">
            <h4 class="text-center">Bonjour <span class="color-darkGreen">{{ app.user.firstName }}</span> !</h4>
            <p class="text-muted text-center">Sélectionnez une section pour afficher le contenu.</p>

            {% if reservationsRentals|length == 0 %}
                <p class="alert-secondary">Vous n'avez pas de logement en attentes/cours</p>
            {% else %}
                <p class="alert alert-secondary text-center">Vous avez {{ reservationsRentals|length }} logements en attentes/cours</p>
            {% endif %}

            {% if reservationsEvents|length == 0 %}
                <p class="alert-secondary">Vous n'avez pas d'événements en attentes/cours</p>
            {% else %}
                <p class="alert alert-secondary text-center">Vous avez {{ reservationsEvents|length }} événements en attentes/cours</p>
            {% endif %}



            <table class="table table-active">
                <thead>
                <tr>
                    <th class="text-center">Image</th>
                    <th>Nom de la location</th>
                    <th class="text-center">Date de début</th>
                    <th class="text-center">Date de fin</th>
                </tr>
                </thead>
                <tbody>
                {% for reservation in reservationsRentals %}
                    <tr>
                        <td class="align-middle text-center">
                            <img src="{{ asset('styles/img/' ~ reservation.rentals.getHomePageImage().getSrc()) }}" alt="{{ asset('styles/img/' ~ reservation.rentals.getHomePageImage().getAlt()) }}" class="iconImage rounded-3">
                        </td>
                        <td class="align-middle">{{ reservation.rentals.title|capitalize }}</td>
                        <td class="align-middle text-center">{{ reservation.dateStart|date('d/m/Y') }}</td>
                        <td class="align-middle text-center">{{ reservation.dateEnd|date('d/m/Y') }}</td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="3">Aucune réservation trouvée.</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <table class="table table-active">
                <thead>
                <tr>
                    <th class="text-center">Image</th>
                    <th>Nom de l'événement</th>
                    <th class="text-center">Date</th>
                    <th class="text-center">nombre de place</th>
                </tr>
                </thead>
                <tbody>
                {% for reservation in reservationsEvents %}
                    <tr>
                        <td class="align-middle text-center">
                            <img src="{{ asset('styles/img/' ~ reservation.event.getHomePageImage().getSrc()) }}" alt="{{ asset('styles/img/' ~ reservation.event.getHomePageImage().getAlt()) }}" class="iconImage rounded-3">
                        </td>
                        <td class="align-middle">{{ reservation.event.title|capitalize }}</td>
                        <td class="align-middle text-center">{{ reservation.event.date|date('d/m/Y') }}</td>
                        <td class="align-middle text-center">{{ reservation.nbPlaces }} places</td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="3">Aucune réservation trouvée.</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

        </turbo-frame>
    </div>
{% endblock %}
