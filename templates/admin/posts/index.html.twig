{% extends 'base.html.twig' %}

{% block title %}Tous les nouveautés{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/admin/datatable.js') }}"></script>
    <script src="{{ asset('js/admin/deleteModal.js') }}"></script>
{% endblock %}

{% block body %}
    <link rel="stylesheet" href="https://cdn.datatables.net/2.3.0/css/dataTables.bootstrap5.css">
    <div class="contentMargin d-flex flex-column align-items-center justify-content-center mb-5">
        <div class="d-flex w-75 justify-content-start gap-2">
            <a href="{{ path('app_admin') }}" class="btn-yellow mb-4">Revenir à l'administration</a>
        </div>

        <div class="w-75 p-4 rounded-4 d-flex flex-column justify-content-center align-items-cente">
            <h1 class="text-center">Tous les nouveautés</h1>


            {% if posts|length > 0 %}
                <table class="table table-hover w-75r" id="myTable">
                    <thead>
                    <tr>
                        <th class="align-middle text-center">Id</th>
                        <th>Titre</th>
                        <th class="align-middle text-center">Contenu</th>
                        <th class="align-middle text-center">Créé le</th>
                        <th class="align-middle text-center">Actif</th>
                        <th class="align-middle text-center">Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for post in posts %}
                        <tr>
                            <td class="align-middle text-center">{{ post.id }}</td>
                            <td class="align-middle">
                                <a href="{{ path('app_post', {'id': post.id}) }}" data-turbo="false">
                                    {{ post.title|slice(0, 100) ~ '...' }}
                                </a>
                            </td>
                            <td class="align-middle">{{ post.content|slice(0, 100) ~ '...' }}</td>
                            <td class="align-middle text-center">{{ post.createdAt ? post.createdAt|date('d/m/Y') : '' }}</td>
                            <td class="align-middle text-center">{{ post.isActive ? '✅️' : '❌' }}</td>
                            <td class="align-middle text-center">
                                <div class="d-flex gap-2 justify-content-center">
                                    <a href="{{ path('app_posts_edit', {'id': post.id}) }}" class="btn btn-dark">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="#006633" fill-rule="evenodd" clip-rule="evenodd"><path d="M11.32 6.176H5c-1.105 0-2 .949-2 2.118v10.588C3 20.052 3.895 21 5 21h11c1.105 0 2-.948 2-2.118v-7.75l-3.914 4.144A2.46 2.46 0 0 1 12.81 16l-2.681.568c-1.75.37-3.292-1.263-2.942-3.115l.536-2.839c.097-.512.335-.983.684-1.352z"/><path d="M19.846 4.318a2.2 2.2 0 0 0-.437-.692a2 2 0 0 0-.654-.463a1.92 1.92 0 0 0-1.544 0a2 2 0 0 0-.654.463l-.546.578l2.852 3.02l.546-.579a2.1 2.1 0 0 0 .437-.692a2.24 2.24 0 0 0 0-1.635M17.45 8.721L14.597 5.7L9.82 10.76a.54.54 0 0 0-.137.27l-.536 2.84c-.07.37.239.696.588.622l2.682-.567a.5.5 0 0 0 .255-.145l4.778-5.06Z"/></g></svg>
                                    </a>
                                    <a href="#" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#deleteModal" data-id="{{ post.id }}">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#CE1104" d="M7 21q-.825 0-1.412-.587T5 19V6q-.425 0-.712-.288T4 5t.288-.712T5 4h4q0-.425.288-.712T10 3h4q.425 0 .713.288T15 4h4q.425 0 .713.288T20 5t-.288.713T19 6v13q0 .825-.587 1.413T17 21zm3-4q.425 0 .713-.288T11 16V9q0-.425-.288-.712T10 8t-.712.288T9 9v7q0 .425.288.713T10 17m4 0q.425 0 .713-.288T15 16V9q0-.425-.288-.712T14 8t-.712.288T13 9v7q0 .425.288.713T14 17"/></svg>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="6">no records found</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p class="alert alert-secondary">Aucun poste</p>
            {% endif %}
        </div>

        <a href="{{ path('app_posts_new') }}" class="btn-yellow">Créer un nouveau post</a>
    </div>

    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="deleteModalLabel">Confirmation de suppression</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    Êtes-vous sûr de vouloir supprimer cet article ?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <a id="confirmDeleteBtn" href="#" class="btn btn-danger">Supprimer</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
